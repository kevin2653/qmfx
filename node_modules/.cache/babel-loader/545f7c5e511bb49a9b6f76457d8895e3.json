{"remainingRequest":"E:\\HtmlProjects\\qmfx\\node_modules\\babel-loader\\lib\\index.js!E:\\HtmlProjects\\qmfx\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\HtmlProjects\\qmfx\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HtmlProjects\\qmfx\\src\\components\\prod\\prodInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\HtmlProjects\\qmfx\\src\\components\\prod\\prodInfo.vue","mtime":1578412477773},{"path":"E:\\HtmlProjects\\qmfx\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1577370171724},{"path":"E:\\HtmlProjects\\qmfx\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\qmfx\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1577370171724},{"path":"E:\\HtmlProjects\\qmfx\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getProdDetailAPI, getprodTypeListtAPI, pushProdDataAPI, putProdDataAPI, getTemplateListAPI } from '@/api/productApi.js';\nimport axios from 'axios';\nimport { treeDataTranslate, idList } from '@/utils';\nimport E from 'wangeditor';\nexport default {\n  name: 'editor',\n  data: function data() {\n    return {\n      // 分类树展示与回显\n      videoFlag: false,\n      //刚开始的时候显示为flase\n      videoUploadPercent: '0%',\n      //进度条刚开始的时候为0%\n      transportId: null,\n      shopid: 0,\n      video: {},\n      shopup: '1',\n      shopdown: '1',\n      value1: '',\n      attrtext: '',\n      attributeDepList: [],\n      category: {\n        list: [],\n        selected: [],\n        props: {\n          value: 'categoryId',\n          label: 'categoryName'\n        }\n      },\n      rules: {\n        checkList: [{\n          type: 'array',\n          required: true,\n          message: '请选择代理购买方式',\n          trigger: 'change'\n        }],\n        picfile: [{\n          required: true,\n          message: '请上传图片'\n        }]\n      },\n      showvidio: '',\n      fileList: [],\n      prodtypelist: [],\n      allfreight: '',\n      AttributeDepShow: false,\n      secondDepShow: false,\n      imageShowUrl: '',\n      // 规格列表\n      shoptypelist: [],\n      skuList: [],\n      prodName: '',\n      dialogImageUrl: '',\n      dialogVisible: false,\n      dataForm: {\n        cover: '',\n        typeId: '',\n        productImageList: []\n      },\n      tags: [],\n      retailFreightId: '',\n      freightlist: [] // resourcesUrl: window.SITE_CONFIG.resourcesUrl\n\n    };\n  },\n  components: {},\n  props: {\n    depId: {\n      required: true\n    }\n  },\n  computed: {\n    defalutSku: function defalutSku() {\n      return this.$store.state.prod.defalutSku;\n    }\n  },\n  activated: function activated() {\n    this.dataForm.prodId = this.$route.query.prodId;\n    this.getDataList();\n  },\n  methods: {\n    // 获取分类数据\n    getDataList: function getDataList() {},\n    delvidio: function delvidio() {\n      this.dataForm.video = '';\n    },\n    handleRemove: function handleRemove(file, fileList) {\n      // let this.dataForm.productImageDtos\n      for (var i = 0; i < this.dataForm.productImageList.length; i++) {\n        if (file.url == this.dataForm.productImageList[i].url) {\n          this.dataForm.productImageList.splice(i, 1);\n        }\n      }\n    },\n    uploadImgTwo: function uploadImgTwo(res) {\n      this.dataForm.productImageList.push({\n        sort: 0,\n        url: res.data\n      });\n    },\n    handlePictureCardPreview: function handlePictureCardPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    },\n    removeDomain: function removeDomain(item) {\n      for (var j = 0; j < this.attributeDepList.length; j++) {\n        if (this.attributeDepList[j].name == item.name) {\n          this.attributeDepList.splice(j, 1);\n        }\n      }\n    },\n    delshoptype: function delshoptype(deltid) {\n      for (var i = 0; i < this.shoptypelist.length; i++) {\n        if (this.shoptypelist[i].tid == deltid) {\n          this.shoptypelist.splice(i, 1);\n        }\n      }\n    },\n    uploadImg: function uploadImg(res) {\n      this.dataForm.cover = res.data;\n      this.imageShowUrl = res.data;\n      this.rules.picfile = [{\n        required: true,\n        message: '请上传图片'\n      }];\n\n      if (this.dataForm.cover != '') {\n        this.rules.picfile = [];\n      }\n    },\n    beforeAvatarUpload: function beforeAvatarUpload(file) {\n      var isJPG = file.type === 'image/jpeg' || file.type === 'image/png';\n      var isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG或者PNG 格式!');\n      }\n\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n\n      return isJPG && isLt2M;\n    },\n    // 视频上传\n    beforeUploadVideo: function beforeUploadVideo(file) {\n      //视频上传之前判断他的大小\n      var isLt10M = file.size / 1024 / 1024 < 2000;\n\n      if (!isLt10M) {\n        this.$message.error('上传视频大小不能超过2000MB哦!');\n        return false;\n      }\n    },\n    uploadVideoProcess: function uploadVideoProcess(event, file, fileList) {\n      //视频上传的时候获取上传进度传给进度条\n      this.videoFlag = true;\n      this.videoUploadPercent = parseInt(file.percentage); // console.log(this.videoUploadPercent)\n    },\n    handleVideoSuccess: function handleVideoSuccess(res, file) {\n      //视频上传成功之后返回视频地址\n      this.videoFlag = false;\n      this.videoUploadPercent = 0; // console.log(res)\n\n      this.dataForm.video = '';\n      console.log(this.dataForm.video);\n      this.dataForm.video = res.data;\n    },\n    // 表单提交\n    dataFormSubmit: function dataFormSubmit() {\n      var _this = this;\n\n      var that = this;\n      this.$refs['dataForm'].validate(function (valid) {\n        if (valid) {\n          if (_this.shopid != 0) {\n            var putdata = {\n              cover: _this.dataForm.cover,\n              detailMobile: _this.dataForm.detailMobile,\n              price: _this.dataForm.price,\n              typeId: _this.dataForm.typeId,\n              productImageList: _this.dataForm.productImageList,\n              productIntro: _this.dataForm.productIntro,\n              productNumber: _this.dataForm.productNumber,\n              sales: _this.dataForm.sales,\n              title: _this.dataForm.title,\n              totalStock: _this.dataForm.totalStock,\n              video: _this.dataForm.video,\n              pid: _this.shopid,\n              retailFreightId: _this.dataForm.retailFreightId\n            };\n            putProdDataAPI(putdata).then(function (res) {\n              var sucresponse = res.data;\n\n              if (sucresponse.code == 200) {\n                _this.$message({\n                  type: 'success',\n                  message: '修改产品成功'\n                });\n\n                _this.$emit('close-form');\n\n                _this.$emit('finish-action');\n              } else {\n                _this.errorMsg(sucresponse.message);\n              }\n            }).catch(function (err) {\n              console.log(err);\n              _this.tableLoading = false;\n            });\n          } else {\n            var pushdata = {\n              cover: _this.dataForm.cover,\n              detailMobile: _this.dataForm.detailMobile,\n              price: _this.dataForm.price,\n              typeId: _this.dataForm.typeId,\n              productImageList: _this.dataForm.productImageList,\n              productIntro: _this.dataForm.productIntro,\n              productNumber: _this.dataForm.productNumber,\n              sales: _this.dataForm.sales,\n              title: _this.dataForm.title,\n              totalStock: _this.dataForm.totalStock,\n              video: _this.dataForm.video,\n              retailFreightId: _this.dataForm.retailFreightId\n            };\n            pushProdDataAPI(pushdata).then(function (res) {\n              var response = res.data;\n\n              if (response.code == 200) {\n                _this.$message({\n                  type: 'success',\n                  message: '添加产品成功'\n                });\n\n                _this.$emit('close-form');\n\n                _this.$emit('finish-action');\n              } else {\n                _this.errorMsg(response.message);\n              }\n            }).catch(function (err) {\n              console.log(err);\n              _this.tableLoading = false;\n            });\n          }\n        }\n      });\n    },\n    getproddetail: function getproddetail(id) {\n      var _this2 = this;\n\n      getProdDetailAPI(id).then(function (res) {\n        var data = res.data.data;\n        console.log(data);\n        _this2.dataForm = data;\n        var editor = new E('#editorElem');\n\n        editor.customConfig.onchange = function (html) {\n          _this2.dataForm.detailMobile = html;\n        };\n\n        _this2.rules.picfile = [{\n          required: true,\n          message: '请上传图片'\n        }];\n\n        if (_this2.dataForm.cover != '') {\n          _this2.rules.picfile = [];\n        }\n\n        editor.customConfig.customUploadImg = function (files, insert) {\n          var formData = new FormData();\n          formData.append('files', files[0]);\n          axios.post(\"http://admin.zhanchengwlkj.com:8080/distribution_backstage/file/addFile\", formData, {\n            headers: {\n              \"Content-Type\": \"multipart/form-data\"\n            }\n          }).then(function (res) {\n            var data = res.data;\n            insert(data.data); // 插入图片到editor\n          }); // formData.append('path', 'files/ne-icev3-dashboard/content/content/');\n        };\n\n        editor.customConfig.uploadImgShowBase64 = true; //图片以base64形式保存\n\n        editor.create();\n        editor.txt.html(_this2.dataForm.detailMobile);\n      }).catch(function (err) {\n        _this2.tableLoading = false;\n      });\n    },\n    errorMsg: function errorMsg(message) {\n      this.$message({\n        message: message,\n        type: 'error',\n        duration: 1500\n      });\n    },\n    getfreightlist: function getfreightlist() {\n      var _this3 = this;\n\n      var getTempParam = {\n        current: 1,\n        size: 100\n      };\n      getTemplateListAPI(getTempParam).then(function (res) {\n        var response = res.data.data.records;\n        _this3.freightlist = response;\n      }).catch(function (err) {\n        _this3.tableLoading = false;\n      });\n    },\n    geprodTypelist: function geprodTypelist() {\n      var _this4 = this;\n\n      var getTempParam = {\n        current: 1,\n        size: 100\n      };\n      getprodTypeListtAPI(getTempParam).then(function (res) {\n        var response = res.data.data;\n        _this4.prodtypelist = response;\n      }).catch(function (err) {\n        _this4.tableLoading = false;\n      });\n    }\n  },\n  mounted: function mounted() {\n    var _this5 = this;\n\n    //wangEditor自带方法\n    if (this.depId != 0) {\n      this.shopid = this.depId;\n      this.getproddetail(this.depId);\n    } else {\n      var editor = new E('#editorElem');\n      editor.customConfig.uploadImgShowBase64 = true; //图片以base64形式保存\n\n      editor.customConfig.onchange = function (html) {\n        _this5.dataForm.detailMobile = html;\n      };\n\n      editor.customConfig.customUploadImg = function (files, insert) {\n        var formData = new FormData();\n        formData.append('files', files[0]);\n        axios.post(\"http://admin.zhanchengwlkj.com:8080/distribution_backstage/file/addFile\", formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\"\n          }\n        }).then(function (res) {\n          var data = res.data;\n          insert(data.data); // 插入图片到editor\n        }); // formData.append('path', 'files/ne-icev3-dashboard/content/content/');\n      };\n\n      editor.customConfig.uploadImgShowBase64 = true; //图片以base64形式保存\n\n      editor.create();\n    }\n\n    this.geprodTypelist();\n    this.getfreightlist();\n  }\n};",{"version":3,"sources":["prodInfo.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"mod-prod-info\">\n    <el-form :model=\"dataForm\"\n             ref=\"dataForm\"\n             :rules=\"rules\"\n             label-width=\"150px\">\n      <el-form-item label=\"商品名称:\"\n                    prop=\"title\"\n                    :rules=\"[{ required: true, message: '商品名称不能为空'}]\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.title\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"商品视频:\">\n      <el-upload\n                    class=\"avatar-uploader\"\n                    action=\"http://admin.zhanchengwlkj.com:8080/distribution_backstage/file/addFile\"\n                    accept='.mp4,.qlv,.qsv,.ogg,.flv,.avi,.wmv,.rmvb'  \n                    :data=\"video\"                              \n                    :show-file-list=\"false\"\n                    name='files'\n                    :before-upload=\"beforeUploadVideo\"   \n                    :on-success=\"handleVideoSuccess\"                   \n                    :on-progress=\"uploadVideoProcess\">                 \n                    <video\n                      v-if=\"dataForm.video !='' && videoFlag == false\"\n                      :src=\"dataForm.video\"\n                      width=\"350\"\n                      height=\"180\"\n                      controls=\"controls\"\n                    >您的浏览器不支持视频播放</video>    \n                    <i\n                      v-else-if=\"dataForm.video =='' && videoFlag == false\"\n                      class=\"el-icon-plus avatar-uploader-icon\"\n                    ></i>            \n                    <el-progress\n                      v-if=\"videoFlag == true\"\n                      type=\"circle\"\n                      :percentage=\"videoUploadPercent\"\n                      style=\"margin-top:30px\"\n                    ></el-progress>    \n                  </el-upload>\n        <el-button @click=\"delvidio\">删除</el-button>\n      </el-form-item>\n      <el-form-item label=\"商品主图:\" prop=\"picfile\">\n        <el-upload\n            class=\"avatar-uploader\"\n            action=\"http://admin.zhanchengwlkj.com:8080/distribution_backstage/file/addFile\"\n            :show-file-list=\"false\"\n            :auto-upload=\"true\"\n            name=\"files\"\n            :on-success=\"uploadImg\"\n            :before-upload=\"beforeAvatarUpload\">\n            <img v-if=\"dataForm.cover\" :src=\"dataForm.cover\" class=\"avatar\">\n            <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n        </el-upload>\n      </el-form-item>\n      <el-form-item label=\"商品图片:\">\n       <el-upload\n        action=\"http://admin.zhanchengwlkj.com:8080/distribution_backstage/file/addFile\"\n        list-type=\"picture-card\"\n        name='files'\n        :file-list=\"dataForm.productImageList\"\n        :auto-upload=\"true\"\n        :on-success=\"uploadImgTwo\"\n        :on-preview=\"handlePictureCardPreview\"\n        :on-remove=\"handleRemove\">\n        <i class=\"el-icon-plus\"></i>\n      </el-upload>\n      <el-dialog :visible.sync=\"dialogVisible\">\n        <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\n      </el-dialog>\n      </el-form-item>\n       <el-form-item style=\"margin-top:10px\"  label=\"商品分类(必选)\">\n            <el-select  v-model=\"dataForm.typeId\"  placeholder=\"请选择\">\n               <el-option\n                v-for=\"item in prodtypelist\"\n                :key=\"item.tid\"\n                :label=\"item.title\"\n                :value=\"item.tid\">\n              </el-option>\n            </el-select>\n      </el-form-item> \n      <el-form-item label=\"商品货号:\"\n                    prop=\"productNumber\"\n                    :rules=\"[{ required: true, message: '商品货号不能为空'}]\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.productNumber\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"库存:\"\n                    prop=\"totalStock\"\n                    :rules=\"[{ required: true, message: '库存不能为空'}]\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.totalStock\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item label=\"商品零售价:\"\n                    prop=\"price\"\n                    :rules=\"[{ required: true, message: '商品零售价不能为空'}]\">\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.price\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n\n       \n     \n        \n      <el-form-item  label=\"运费模板：\">\n        <el-select v-model=\"dataForm.retailFreightId\"   placeholder=\"请选择\">\n          <el-option\n            v-for=\"item in freightlist\"\n            :key=\"item.id\"\n            :label=\"item.title\"\n            :value=\"item.id\">\n          </el-option>\n        </el-select>\n      </el-form-item>\n      \n\n      <el-form-item label=\"简介:\"\n                    prop=\"productIntro\"\n                   >\n        <el-col :span=\"8\">\n          <el-input v-model=\"dataForm.productIntro\"\n                    placeholder=\"请输入\"\n                    maxlength=\"50\"></el-input>\n        </el-col>\n      </el-form-item>\n      <el-form-item  label=\"商品详情：\">\n          <div id=\"editorElem\"  style=\"text-align:left\"></div>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\"\n                   @click=\"dataFormSubmit()\">确定</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport {\n  getProdDetailAPI,\n  getprodTypeListtAPI,\n  pushProdDataAPI,\n  putProdDataAPI,\n  getTemplateListAPI\n}from '@/api/productApi.js'\nimport axios from 'axios';\nimport { treeDataTranslate, idList } from '@/utils'\nimport E from 'wangeditor';\nexport default {\n   name:'editor',\n  data () {\n    return {\n      // 分类树展示与回显\n       videoFlag:false,      //刚开始的时候显示为flase\n      videoUploadPercent: '0%',  //进度条刚开始的时候为0%\n      transportId: null,\n      shopid:0,\n      video:{},\n      shopup:'1',\n      shopdown:'1',\n      value1:'',\n      attrtext:'',\n      attributeDepList:[],\n      category: {\n        list: [],\n        selected: [],\n        props: {\n          value: 'categoryId',\n          label: 'categoryName'\n        }\n      },\n      rules: {\n        checkList: [\n                { type: 'array', required: true, message: '请选择代理购买方式', trigger: 'change' }\n              ],\n        picfile: [ \n            { required: true, message: '请上传图片' }          \n          ]\n      },\n      showvidio:'',\n      fileList:[],\n      prodtypelist:[],\n      allfreight:'',\n      AttributeDepShow:false,\n      secondDepShow:false,\n      imageShowUrl:'',\n      // 规格列表\n      shoptypelist:[],\n      skuList:[],\n      prodName:'',\n      dialogImageUrl: '',\n      dialogVisible: false,\n      dataForm: {\n        cover:'',\n        typeId:'',\n        productImageList:[]\n      },\n      tags: [],\n      retailFreightId:'',\n      freightlist:[]\n      // resourcesUrl: window.SITE_CONFIG.resourcesUrl\n    }\n  },\n  components: {\n  },\n  props: {\n    depId: {\n      required: true,\n    },\n  },\n  computed: {\n    defalutSku () {\n      return this.$store.state.prod.defalutSku\n    }\n  },\n  activated () {\n    this.dataForm.prodId = this.$route.query.prodId\n    this.getDataList()\n  },\n  methods: {\n    // 获取分类数据\n    getDataList () {\n     \n    },\n    delvidio(){\n      this.dataForm.video =''\n    },\n    handleRemove(file, fileList) {\n      // let this.dataForm.productImageDtos\n      for(let i=0;i<this.dataForm.productImageList.length;i++){\n        if(file.url==this.dataForm.productImageList[i].url){\n          this.dataForm.productImageList.splice(i,1)\n        }\n      }\n    },\n    uploadImgTwo(res){\n      this.dataForm.productImageList.push({\n        sort:0,\n        url:res.data\n      })\n    },\n    handlePictureCardPreview(file) {\n        this.dialogImageUrl = file.url;\n        this.dialogVisible = true;\n    },\n    removeDomain(item) {\n        for(let j=0;j<this.attributeDepList.length;j++){\n          if(this.attributeDepList[j].name==item.name){\n            this.attributeDepList.splice(j,1)\n          }\n        }\n      },\n    delshoptype(deltid){\n     for(let i=0;i<this.shoptypelist.length;i++){\n       if(this.shoptypelist[i].tid==deltid){\n         this.shoptypelist.splice(i,1)\n       }\n     }\n    },\n    uploadImg(res){\n      this.dataForm.cover = res.data;\n      this.imageShowUrl=res.data\n      this.rules.picfile = [{ required: true, message: '请上传图片' }] \n      if (this.dataForm.cover!='') {\n        this.rules.picfile = []\n      }\n    },\n    beforeAvatarUpload(file) {\n      const isJPG = file.type === 'image/jpeg' || file.type === 'image/png';\n      const isLt2M = file.size / 1024 / 1024 < 2;\n\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG或者PNG 格式!');\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!');\n      }\n      return isJPG && isLt2M;\n    },\n    // 视频上传\n     beforeUploadVideo(file) {          //视频上传之前判断他的大小\n      const isLt10M = file.size / 1024 / 1024  < 2000;\n      if (!isLt10M) {\n        this.$message.error('上传视频大小不能超过2000MB哦!');\n        return false;\n      }\n    },\n    uploadVideoProcess(event, file, fileList){    //视频上传的时候获取上传进度传给进度条\n      this.videoFlag = true;\n      this.videoUploadPercent = parseInt(file.percentage);\n      // console.log(this.videoUploadPercent)\n    },\n    handleVideoSuccess(res, file) {           //视频上传成功之后返回视频地址\n      this.videoFlag = false;\n      this.videoUploadPercent = 0;\n      // console.log(res)\n      this.dataForm.video=''\n      console.log(this.dataForm.video)\n      this.dataForm.video = res.data;\n    },\n    // 表单提交\n    dataFormSubmit () {\n          let that=this;\n        this.$refs['dataForm'].validate((valid) => {\n          if(valid){\n            if(this.shopid!=0){\n              const putdata={\n                cover: this.dataForm.cover,\n                detailMobile: this.dataForm.detailMobile,\n                price: this.dataForm.price,\n                typeId:this.dataForm.typeId,\n                productImageList:this.dataForm.productImageList,\n                productIntro: this.dataForm.productIntro,\n                productNumber: this.dataForm.productNumber,\n                sales: this.dataForm.sales,\n                title: this.dataForm.title,\n                totalStock: this.dataForm.totalStock,\n                video: this.dataForm.video,\n                pid:this.shopid,\n                retailFreightId:this.dataForm.retailFreightId\n              }\n              putProdDataAPI(putdata)\n                .then(res => {\n                    const sucresponse = res.data;\n                    if(sucresponse.code==200){\n                      this.$message({\n                        type: 'success',\n                        message: '修改产品成功',\n                      });\n                      this.$emit('close-form')\n                      this.$emit('finish-action')\n                    }else{\n                      this.errorMsg(sucresponse.message)\n                    }\n                })\n                .catch(err => {\n                  console.log(err)\n                    this.tableLoading = false;\n                }) \n            }else{\n              const pushdata={\n                cover: this.dataForm.cover,\n                detailMobile: this.dataForm.detailMobile,\n                price: this.dataForm.price,\n                typeId:this.dataForm.typeId,\n                productImageList:this.dataForm.productImageList,\n                productIntro: this.dataForm.productIntro,\n                productNumber: this.dataForm.productNumber,\n                sales: this.dataForm.sales,\n                title: this.dataForm.title,\n                totalStock: this.dataForm.totalStock,\n                video: this.dataForm.video,\n                retailFreightId:this.dataForm.retailFreightId\n              }\n              pushProdDataAPI(pushdata)\n                .then(res => {\n                    const response = res.data;\n                    if(response.code==200){\n                      this.$message({\n                        type: 'success',\n                        message: '添加产品成功',\n                      });\n                      this.$emit('close-form')\n                      this.$emit('finish-action')\n                    }else{\n                      this.errorMsg(response.message)\n                    }\n                })\n                .catch(err => {\n                  console.log(err)\n                    this.tableLoading = false;\n                })            \n            }\n          }\n         \n        })\n    },\n    getproddetail(id){\n      getProdDetailAPI(id)\n        .then(res => {\n          const data = res.data.data;\n          console.log(data)\n          this.dataForm=data\n            var editor = new E('#editorElem')\n            editor.customConfig.onchange = (html) => {\n              this.dataForm.detailMobile = html\n            }\n            this.rules.picfile = [{ required: true, message: '请上传图片' }] \n            if (this.dataForm.cover!='') {\n              this.rules.picfile = []\n            }\n            editor.customConfig.customUploadImg = (files, insert) => {\n              const formData = new FormData();\n              formData.append('files', files[0]);\n               axios.post(\"http://admin.zhanchengwlkj.com:8080/distribution_backstage/file/addFile\", formData, {\n                  headers: {\n                    \"Content-Type\": \"multipart/form-data\"\n                  }\n                }).then(res => {\n                  let { data } = res\n                  insert(data.data)  \n                  // 插入图片到editor\n                });\n              // formData.append('path', 'files/ne-icev3-dashboard/content/content/');\n              \n            };\n            editor.customConfig.uploadImgShowBase64 = true //图片以base64形式保存\n            editor.create()\n            editor.txt.html(this.dataForm.detailMobile)\n        })\n        .catch(err => {\n            this.tableLoading = false;\n        })\n    },\n    errorMsg (message) {\n      this.$message({\n        message: message,\n        type: 'error',\n        duration: 1500\n      })\n    },\n    getfreightlist(){\n        const getTempParam = {\n          current:1,\n          size:100\n        };\n        getTemplateListAPI(getTempParam)\n            .then(res => {\n                const response = res.data.data.records;\n                this.freightlist =response\n            })\n            .catch(err => {\n                this.tableLoading = false;\n            })\n    },\n  \n    geprodTypelist(){\n        const getTempParam = {\n          current:1,\n          size:100\n        };\n        getprodTypeListtAPI(getTempParam)\n            .then(res => {\n                const response = res.data.data;\n                this.prodtypelist =response\n            })\n            .catch(err => {\n                this.tableLoading = false;\n            })\n    }\n  },\n  mounted() {\n        //wangEditor自带方法\n        if(this.depId!=0){\n          this.shopid=this.depId\n          this.getproddetail(this.depId)\n        }else{\n            var editor = new E('#editorElem')\n            editor.customConfig.uploadImgShowBase64 = true //图片以base64形式保存\n            editor.customConfig.onchange = (html) => {\n              this.dataForm.detailMobile = html\n            }\n            editor.customConfig.customUploadImg = (files, insert) => {\n              const formData = new FormData();\n              formData.append('files', files[0]);\n               axios.post(\"http://admin.zhanchengwlkj.com:8080/distribution_backstage/file/addFile\", formData, {\n                  headers: {\n                    \"Content-Type\": \"multipart/form-data\"\n                  }\n                }).then(res => {\n                  let { data } = res\n                  insert(data.data)  \n                  // 插入图片到editor\n                });\n              // formData.append('path', 'files/ne-icev3-dashboard/content/content/');\n              \n            };\n            editor.customConfig.uploadImgShowBase64 = true //图片以base64形式保存\n            editor.create();\n            \n        }\n        this.geprodTypelist();\n        this.getfreightlist();\n    },\n}\n</script>\n<style scoped=\"scoped\" lang=\"less\">\n.mbline{\n  margin-top:24px;\n  padding-left: 20px;\n  line-height: 40px;\n  background: rgb(249, 249, 249);\n}\n\n.avatar-uploader .el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n  }\n  .avatar-uploader .el-upload:hover {\n    border-color: #409EFF;\n  }\n  .avatar-uploader-icon {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n  }\n  .avatar {\n    width: 178px;\n    height: 178px;\n    display: block;\n  }\n</style>"],"sourceRoot":"src\\components\\prod"}]}