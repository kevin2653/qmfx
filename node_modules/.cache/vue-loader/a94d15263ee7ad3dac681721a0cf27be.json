{"remainingRequest":"E:\\HtmlProjects\\qmfx\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\HtmlProjects\\qmfx\\src\\components\\allOrderManage\\orderLogisticInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\HtmlProjects\\qmfx\\src\\components\\allOrderManage\\orderLogisticInfo.vue","mtime":1579186746352},{"path":"E:\\HtmlProjects\\qmfx\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\HtmlProjects\\qmfx\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1577370171724},{"path":"E:\\HtmlProjects\\qmfx\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\n\r\nimport {\r\n     getOrderLogisticDetailAPI,\r\n     saveOrderLogisticAPI,\r\n     updateOrderLogisticAPI\r\n} from '@/api/prodOrderLogisticAPI.js'\r\nimport {\r\n     getOrderDetailAPI,\r\n} from '@/api/prodOrderAPI.js'\r\nexport default {\r\n    name:'prodList',\r\n    data(){\r\n        return{\r\n            dataForm:{\r\n    \r\n            },\r\n            expressCompanyList:[\r\n                {id:0,name:\"圆通速递\",number:\"YTO\"},\r\n                {id:1,name:\"申通快递\",number:\"STO\"},\r\n                {id:2,name:\"中通快递\",number:\"ZTO\"}\r\n            ]\r\n            ,\r\n            sendway:{\r\n                1:\"快递\",\r\n                2:\"自提\",\r\n                3:\"无需物流\"\r\n            },\r\n            expressCompany:'',\r\n            expressNumber:'',\r\n            logisticCode:'',\r\n            name:'',\r\n            phone:'',\r\n            address:'',\r\n            item:{},\r\n            order:{}\r\n        };\r\n    },\r\n    components:{\r\n        // AddDepModal,\r\n    },\r\n    props: {\r\n        updateId: {\r\n            required: true,\r\n        },\r\n        orderId: {\r\n            required: true,\r\n        }\r\n    },\r\n    methods:{\r\n        /**\r\n         * @msg: 时间处理\r\n         * @param {type} \r\n         * @return: \r\n         */\r\n        timechange(time,type){\r\n            return timeStamp2String(time,type)\r\n        },\r\n        /*\r\n         * 获取详情\r\n         */\r\n        getDetail(id){\r\n            this.tableLoading = true;\r\n             getOrderLogisticDetailAPI(id)\r\n                .then(res => {\r\n                    const orderdata=res.data.data\r\n                    console.log(orderdata)\r\n                    this.item = orderdata;\r\n                    this.expressCompany = orderdata.expressCompany;\r\n                    this.expressNumber = orderdata.expressNumber;\r\n                    this.logisticCode = orderdata.logisticCode;\r\n                    this.name = orderdata.contactName;\r\n                    this.phone = orderdata.contactPhone;\r\n                    this.address = orderdata.contactAddress;\r\n                    console.log(this.dataForm.expressCompany)\r\n                })\r\n                .catch(err => {\r\n                    this.tableLoading = false;\r\n                })\r\n        },\r\n        dataFormSubmit () {\r\n          \r\n            for(var i=0;i<this.expressCompanyList.length;i++){\r\n                if(this.expressCompanyList[i].name == this.expressCompany){\r\n                    this.expressNumber = this.expressCompanyList[i].number;\r\n                }\r\n            }\r\n            console.log(\"快递公司：\"+this.expressCompany+\" 快递公司编号：\"+this.expressNumber);\r\n            //累加订单产品id\r\n            console.log(this.order);\r\n            var opid = \"\";\r\n            for(var i=0;i<this.order.orderProductVOList.length;i++){\r\n                if(i==this.order.orderProductVOList.length-1){\r\n                    opid+=this.order.orderProductVOList[i].id;\r\n                }else{\r\n                    opid+=this.order.orderProductVOList[i].id+\",\";\r\n                }\r\n               \r\n            }\r\n            console.log(\"opid\"+opid);\r\n        this.$refs['dataForm'].validate((valid) => {\r\n                    const args = {\r\n                        orderId:this.orderId,\r\n                        orderProductId:opid,\r\n                        expressCompany:this.expressCompany,\r\n                        expressNumber:this.expressNumber,\r\n                        logisticCode:this.logisticCode,\r\n                        contactName:this.name,\r\n                        contactPhone:this.phone,\r\n                        contactAddress:this.address\r\n                    };\r\n                    console.log(args);\r\n                 \r\n                    if(this.updateId==0){\r\n                      saveOrderLogisticAPI(args)\r\n                        .then(res => {\r\n                            const data = res.data;\r\n                            if (data.code === 200) {\r\n                                    this.$message({\r\n                                        type: 'success',\r\n                                        message: '添加成功',\r\n                                    });\r\n                                this.$emit('close-form')\r\n                                this.$emit('finish-action')\r\n                            }else{\r\n                                this.$message.error(res.data.msg)\r\n                            }\r\n                        })\r\n                        .catch(err => {\r\n                        });\r\n                    }else{\r\n                      args.id=this.item.id\r\n                      updateOrderLogisticAPI(args)\r\n                        .then(res => {\r\n                            const data = res.data;\r\n                            if (data.code === 200) {\r\n                                    this.$message({\r\n                                        type: 'success',\r\n                                        message: '修改成功',\r\n                                    });\r\n                                this.$emit('close-form')\r\n                                this.$emit('finish-action')\r\n                            }else{\r\n                                this.$message.error(res.data.msg)\r\n                            }\r\n                        })\r\n                        .catch(err => {\r\n                        });\r\n                    }\r\n        })\r\n    },\r\n    /*\r\n         * 获取订单详情\r\n         */\r\n        getOrderDetail(id){\r\n            this.tableLoading = true;\r\n             getOrderDetailAPI(id)\r\n                .then(res => {\r\n                    console.log(res);\r\n                    this.order=res.data.data;\r\n               \r\n                    this.name = this.order.contactName;\r\n                    this.phone = this.order.contactPhone;\r\n                    this.address = this.order.contactAddress;\r\n                })\r\n                .catch(err => {\r\n                    \r\n                })\r\n        },\r\n        \r\n    },\r\n    mounted(){\r\n        if(this.updateId>0){\r\n            this.getDetail(this.updateId)\r\n        }\r\n\r\n        this.getOrderDetail(this.orderId);\r\n    }\r\n}\r\n",null]}